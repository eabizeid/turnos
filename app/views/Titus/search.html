#{extends 'main.html' /}
#{set title:'Titus' /}
      
<script type="text/javascript">



/* Table initialisation */
$(document).ready(function() {
	
	$('#marcaStep').hide();
	$("#tipoStep").hide();
	$("#moreDataButtonType").hide();
	$("#searchButton").hide()
	
} );

openDetail = function(componentId) {
	
	  var action = #{jsAction @viewDetail(':componentId') /}

	   $.post(action({componentId: componentId}), function(data) {
          $("#componentDetail").append(data);
	   });
	  
	  
}

</script>
<div id="teaser">
  <div class="wrap">
    <div id="image"></div>
    <div class="box">
      <h2><em title="Sharing and breakdowning devices">Magic is here!</em></h2>
      <p>You can make a search for anyone attribute of your device and you will get the best results.</p>
    </div>
  </div>
</div>

<div class="wrap">
  <div class="search">
   #{if flash.success}
  	 <div class="alert alert-warning fade in">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
        <strong>${flash.success}</strong> You'll have an answer in 15 minutes.
      </div>
	#{/if}
    <h3>Make a <span class="red">Search </span></h3>
    			
    		#{form @Titus.makeASearch() }
				<div class="form-group" id="modeloStep">
    				<label for="modelo">Conocés el modelo?
    				</label>
    				<input type="text" class="form-control" id="modelo" name="model" >
				</div>
    			<div class="btn-group" data-toggle="buttons" id="marcaStep">
	    			<div><label>Conocés la marca?</label></div>
	    			#{list items:trademarks, as:'t'}
					  <label class="btn btn-primary trademark">
					    <input type="radio" name="trademark" id="option" value="${t.description}">${t.description}
					  </label>
					#{/list}  
				</div>
				<div class="btn-group" data-toggle="buttons" id="tipoStep">
	    			<div><label>Tipo de componente</label></div>
	    			#{list items:types, as:'type'}
					  <label class="btn btn-primary trademark">
					    <input type="radio" name="tipo" id="option1" value="${type.description}"> ${type.description}
					  </label>
					#{/list}  
				</div>
				<br /> <br />
				<br />
				<div class="btn-group">
					<button id="moreDataButton" type="button" onclick="javascript:showNextStep('marca')" 
					class="btn btn-large btn-primary">Siguiente</button>
					<button id="moreDataButtonType" type="button" onclick="javascript:showNextStep('tipo')" 
					class="btn btn-large btn-primary">Siguiente</button>
				    <button id="searchButton" type="submit" class="btn btn-large btn-primary">Buscar</button>
				</div>
			#{/form}
  </div>
</div>
  #{if components != null && components.size()>0}
  <div class="wrap container">
  <h3></h3>
  <h3>Resul<span class="red">tados</span></h3>
  	<table id="results" class="table table-striped">
  		<thead>
  			<tr>
  				<th>Marca</th>
  				<th>Tipo</h>
  				<th>Modelo</th>
  				<th>Submodelo</th>
  				<th>Nro de parte</th>
  				<th></th>
  			</tr>
  		</thead>
  		<tbody>
  			#{list items:components, as:'component'}
  				<tr>
  					<td>${component.marca}</td>
  					<td>${component.tipo}</td>
  					<td>${component.modelo}</td>
  					<td>${component.submodelo}</td>
  					<td>${component.nroDeParte}</td>
  					<td><button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" onclick="javascript: openDetail(${component.id});">Ver</button></td>
  				</tr>
  			#{/list}
  		</tbody>
	</table>
  </div>
  
  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title" id="myModalLabel">Detalle de producto</h4>
	      </div>
	      <div class="modal-body">
  			<div id="componentDetail"></div>
  		  </div>
  		</div>
  	</div>
  </div>
  #{/if}
  #{else}
  	#{if step == 2}
	  #{form @Titus.noResults() }
	  		<div class="wrap">
					<div class="form-group" id="modeloStep">
	    				<label for="mail">No encontramos resultados, pero dejanos tu mail que en 15 minutos te enviamos una respuesta satisfactoria
	    				</label>
	    				<input type="text" class="form-control" id="mail" name="mail" >
	    				<input type="hidden" id="query" name="query" value="${query}"/>
	    				<button type="submit" class="btn btn-large btn-primary">Quiero!</button>
					</div>
			</div>
		#{/form}
	#{/if}
  #{/else}
 
<div id="footer">
  <p class="right">Design: <a href="#">EAZ</a></p>
  <p>&copy; Copyright 2013 <a href="#">Titus Intelligence</a> &middot; All Rights Reserved</p>
</div>
<script type="text/javascript">

<!--
	
	var showNextStep = function(step) {
	 	if (step == 'marca') {
	 		if ( $("#modelo").val() == ""  ) {
				alert("te falta ingresar un modelo, loco");
				return;
	 		}  
	 		else {
	 			$("#modeloStep").hide();
	 			$("#moreDataButton").hide();
	 			$("#tipoStep").hide();
	 			$("#marcaStep").show();
	 			$("#moreDataButtonType").show();
	 			$('.trademark').button();	
	 		}
	 	} else if (step == 'tipo') {
	 		$("#modeloStep").hide();
	 		$("#marcaStep").hide();
 			$("#moreDataButton").hide();
 			$("#moreDataButtonType").hide();
 			$("#tipoStep").show();
 			$("#searchButton").show();
 			$('.trademark').button();	
	 	}
	
	}
//-->
</script>
